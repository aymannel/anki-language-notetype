<!-- Native -> Language-1 (Back) -->

<div id='backSide'>
  <div id='backStatusBar' class='statusBar'>
    <div id='reloadButton' onClick='reloadPage()'>
      <span class='reloadSymbol'>&#10227;</span>
    </div>
    <div id='audioStatus'>&#x1F3A7;</div>
  </div>

  {{FrontSide}}
</div>

<div id='mobileAnswer'>
  {{Language-1}}
</div>

{{#Phonology-1}}
  <div id='phonology'>/{{Phonology-1}}/</div>
{{/Phonology-1}}

{{Image}}


<!-- Scripts -->

<script>

  setTimeout(() => {

    if (Persistence.isAvailable()) {
      reloadPage(Persistence.getItem());
      Persistence.clear();
    }

    // Reveal Elements
    document.getElementById('classification').style.opacity = 1;
    document.getElementById('mobileAnswer').style.opacity = 1;

  }, 0);

  function reloadPage(storedIndex) {
    const wordIndex = storedIndex ?? nextIndex();
    handleAgreementFront(wordIndex);
    handleAgreementBack(wordIndex);
  }

  function handleAgreementBack(storedIndex) {

    const wordIndex = storedIndex ?? 0;
    const words = stripHTML(`{{Language-1}}`).split('/');
    const classification = stripHTML(`{{Classification}}`);
    const audioSources = stripHTML(`{{Audio-1}}`).split(' ');

    const audioPlayer = new Audio();
    const nativeElement = document.getElementById('nativeElement');
    const mobileAnswerElement = document.getElementById('mobileAnswer');
    const classificationElement = document.getElementById('classification');

    const agreementPhrases = [
      '<span style="color: #4E7BFD;">masc.</span> singular',
      '<span style="color: #FE3473;">fem.</span> singular',
      '<span style="color: #4E7BFD;">masc.</span> plural',
      '<span style="color: #FE3473;">fem.</span> plural'
    ];

    if (words.length === 1) {
      audioPlayer.src = audioSources[0];
      audioPlayer.play();
    }

    if (classification === 'adjective') {
      if (words.length === 2) {
        classificationElement.innerHTML = '(' + agreementPhrases[wordIndex] + ')';
        mobileAnswerElement.innerHTML = words[wordIndex < 2 ? 0 : 1];
        audioPlayer.src = audioSources[wordIndex < 2 ? 0 : 1];
        audioPlayer.play();
      }

      else if (words.length === 4) {
        classificationElement.innerHTML = '(' + agreementPhrases[wordIndex] + ')';
        mobileAnswerElement.innerHTML = words[wordIndex];
        audioPlayer.src = audioSources[wordIndex];
        audioPlayer.play();
      }
    }

    else if (classification === 'noun') {
      if (words.length === 2) {
        classificationElement.innerHTML = '(' + ['singular', 'plural'][wordIndex % 2] + ')';
        mobileAnswerElement.innerHTML = words[wordIndex % 2];
        audioPlayer.src = audioSources[wordIndex % 2];
        audioPlayer.play();
      }

      else if (words.length === 4) {
        classificationElement.innerHTML = '(' + agreementPhrases[wordIndex] + ')';
        mobileAnswerElement.innerHTML = words[wordIndex];
        audioPlayer.src = audioSources[wordIndex];
        audioPlayer.play();
      }
    }

  }

</script>