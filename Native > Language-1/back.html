<!-- Native -> Language-1 (Back) -->

<div id='backSide'>
  <div id='backStatusBar' class='statusBar'>
    <div id='reloadButton' onClick='reloadPage()'>
      <span class='reloadSymbol'>&#10227;</span>
    </div>
    <div id='audioStatus'>&#x1F3A7;</div>
  </div>

  {{FrontSide}}
</div>

<div id='mobileAnswer'>
  {{Language-1}}
</div>

{{#Phonology-1}}
  <div id='phonology'>/{{Phonology-1}}/</div>
{{/Phonology-1}}

{{Image}}


<!-- Scripts -->

<script>
 
  function reloadPage(wordIndex = 'undefined') {

    // Initialise Constants
    const audioSources = `{{Audio-1}}`.split(' ');
    const language = stripHTML(`{{Language-1}}`);
    const classification = stripHTML(`{{Classification}}`);
    const newIndex = wordIndex !== 'undefined' ? nextIndex() : wordIndex;

    // Handle Agreement
    handleAgreementFront(newIndex);
    handleAgreementBack(language, classification, audioSources, newIndex);

    // Reveal Elements
    document.getElementById('classification').style.opacity = 1;
    document.getElementById('mobileAnswer').style.opacity = 1;

  }

  function handleAgreementBack(language, classification, audioSources, wordIndex) {

    const words = language.split('/');
    const wordIndex = wordIndex ? wordIndex : 0

    const nativeElement = document.getElementById('nativeElement');
    const mobileAnswerElement = document.getElementById('mobileAnswer');
    const classificationElement = document.getElementById('classification');

    const classificationAgreement = [
      '<span style="color: #4E7BFD;">masc.</span> singular',
      '<span style="color: #FE3473;">fem.</span> singular',
      '<span style="color: #4E7BFD;">masc.</span> plural',
      '<span style="color: #FE3473;">fem.</span> plural'
    ]

    if (words.length === 1) {
      const audioPlayer = new Audio(audioSources[0]);
      audioPlayer.play();
    }

    if (classification === 'adjective') {
      if (words.length === 2) {
        const adjustedIndex = wordIndex < 2 ? 0 : 1;
        mobileAnswerElement.innerHTML = words[adjustedIndex];
        classificationElement.innerHTML = '(' + classificationAgreement[wordIndex] + ')';

        const audioPlayer = new Audio(audioSources[adjustedIndex]);
        audioPlayer.play();
      }

      else if (words.length === 4) {
        mobileAnswerElement.innerHTML = words[wordIndex];
        classificationElement.innerHTML = '(' + classificationAgreement[wordIndex] + ')';

        const audioPlayer = new Audio(audioSources[wordIndex]);
        audioPlayer.play();
      }
    }

    else if (classification === 'noun') {
      if (words.length === 2) {
        const adjustedIndex = wordIndex % 2;
        mobileAnswerElement.innerHTML = words[adjustedIndex];
        classificationElement.innerHTML = '(' + ['singular', 'plural'][adjustedIndex] + ')';

        const audioPlayer = new Audio(audioSources[adjustedIndex]);
        audioPlayer.play();
      }

      else if (words.length === 4) {
        mobileAnswerElement.innerHTML = words[wordIndex];
        classificationElement.innerHTML = '(' + classificationAgreement[wordIndex] + ')';

        const audioPlayer = new Audio(audioSources[wordIndex]);
        audioPlayer.play();
      }
    }

  }

  setTimeout(() => {

    // Nominal Agreement
    if (Persistence.isAvailable()) {
      let wordIndex = Persistence.getItem();
      Persistence.clear();
      reloadPage('undefined');
    }

  }, 0);

</script>